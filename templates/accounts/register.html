{% extends 'base.html' %}
{% load static %}

{% block title %}Register - Ramat Library{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="/" class="text-decoration-none">
    <i class="bi bi-house-door me-1"></i>Home
</a></li>
<li class="breadcrumb-item active" aria-current="page">Register</li>
{% endblock %}

{% block page_header %}
<div class="row mb-5 animate__animated animate__fadeInUp">
    <div class="col">
        <div class="d-flex align-items-center mb-3">
            <div class="me-3">
                <div style="width: 60px; height: 60px; background: var(--gradient-2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                    <i class="bi bi-person-plus fs-3 text-white"></i>
                </div>
            </div>
            <div>
                <h1 class="display-4 fw-bold mb-2">Join Ramat Library</h1>
                <p class="lead text-muted">Create your account to access our resources and services</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<!-- Registration Page Content -->
<div class="registration-page">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card border-0 shadow-lg">
                    <div class="row g-0">
                        <!-- Left Column: Registration Form -->
                        <div class="col-lg-8">
                            <div class="card-body p-5">
                                <div class="mb-4">
                                    <h3 class="fw-bold mb-2">Create Your Account</h3>
                                    <p class="text-muted">Fill in your details to get started</p>
                                </div>
                                
                                <!-- Registration Form -->
                                <form method="post" id="registrationForm" novalidate>
                                    {% csrf_token %}
                                    
                                    <!-- Membership Type Selection -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-person-badge me-2"></i>Select Membership Type
                                            </h6>
                                            <div class="row g-3 membership-cards">
                                                <div class="col-md-6">
                                                    <div class="membership-option" data-type="student">
                                                        <div class="card h-100 border-2 {% if form.membership_type.value == 'student' %}border-primary selected{% else %}border-light{% endif %}">
                                                            <div class="card-body text-center p-4">
                                                                <div class="mb-3">
                                                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #0a2472, #3a86ff); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                                                        <i class="bi bi-mortarboard text-white fs-4"></i>
                                                                    </div>
                                                                </div>
                                                                <h5 class="fw-bold mb-2">Student</h5>
                                                                <p class="text-muted small mb-3">
                                                                    For University of Maiduguri students
                                                                </p>
                                                                <ul class="list-unstyled small text-start mb-0">
                                                                    <li class="mb-2">
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Free membership
                                                                    </li>
                                                                    <li class="mb-2">
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Extended loan periods
                                                                    </li>
                                                                    <li>
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Access to all resources
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <div class="membership-option" data-type="faculty">
                                                        <div class="card h-100 border-2 {% if form.membership_type.value == 'faculty' %}border-primary selected{% else %}border-light{% endif %}">
                                                            <div class="card-body text-center p-4">
                                                                <div class="mb-3">
                                                                    <div style="width: 60px; height: 60px; background: linear-gradient(135deg, #198754, #20c997); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                                                        <i class="bi bi-person-workspace text-white fs-4"></i>
                                                                    </div>
                                                                </div>
                                                                <h5 class="fw-bold mb-2">Faculty</h5>
                                                                <p class="text-muted small mb-3">
                                                                    For University teaching staff
                                                                </p>
                                                                <ul class="list-unstyled small text-start mb-0">
                                                                    <li class="mb-2">
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Research priority access
                                                                    </li>
                                                                    <li class="mb-2">
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Extended borrowing privileges
                                                                    </li>
                                                                    <li>
                                                                        <i class="bi bi-check-circle text-success me-2"></i>
                                                                        Course reserve management
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <input type="hidden" name="membership_type" id="membershipType" value="{{ form.membership_type.value|default:'student' }}" required>
                                            <div class="invalid-feedback" id="membershipTypeError">
                                                Please select a membership type
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Personal Information -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-person me-2"></i>Personal Information
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="firstName" class="form-label">First Name *</label>
                                                    <input type="text" 
                                                           class="form-control {% if form.first_name.errors %}is-invalid{% endif %}" 
                                                           id="firstName" 
                                                           name="first_name" 
                                                           value="{{ form.first_name.value|default:'' }}"
                                                           required>
                                                    {% if form.first_name.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.first_name.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="lastName" class="form-label">Last Name *</label>
                                                    <input type="text" 
                                                           class="form-control {% if form.last_name.errors %}is-invalid{% endif %}" 
                                                           id="lastName" 
                                                           name="last_name" 
                                                           value="{{ form.last_name.value|default:'' }}"
                                                           required>
                                                    {% if form.last_name.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.last_name.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="username" class="form-label">Username *</label>
                                                    <input type="text" 
                                                           class="form-control {% if form.username.errors %}is-invalid{% endif %}" 
                                                           id="username" 
                                                           name="username" 
                                                           value="{{ form.username.value|default:'' }}"
                                                           required>
                                                    {% if form.username.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.username.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                    <div class="form-text">
                                                        Choose a unique username (letters, numbers, and underscores only)
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="email" class="form-label">Email Address *</label>
                                                    <input type="email" 
                                                           class="form-control {% if form.email.errors %}is-invalid{% endif %}" 
                                                           id="email" 
                                                           name="email" 
                                                           value="{{ form.email.value|default:'' }}"
                                                           required>
                                                    {% if form.email.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.email.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                    <div class="form-text">
                                                        Use your university email if available
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Password Section -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-shield-lock me-2"></i>Account Security
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="password1" class="form-label">Password *</label>
                                                    <div class="input-group">
                                                        <input type="password" 
                                                               class="form-control {% if form.password1.errors %}is-invalid{% endif %}" 
                                                               id="password1" 
                                                               name="password1"
                                                               required>
                                                        <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('password1', this)">
                                                            <i class="bi bi-eye"></i>
                                                        </button>
                                                        {% if form.password1.errors %}
                                                        <div class="invalid-feedback">
                                                            {{ form.password1.errors.0 }}
                                                        </div>
                                                        {% endif %}
                                                    </div>
                                                    <div class="password-strength mt-2">
                                                        <div class="progress" style="height: 6px;">
                                                            <div class="progress-bar" id="passwordStrengthBar" style="width: 0%;"></div>
                                                        </div>
                                                        <small class="text-muted" id="passwordStrengthText">Password strength</small>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="password2" class="form-label">Confirm Password *</label>
                                                    <div class="input-group">
                                                        <input type="password" 
                                                               class="form-control {% if form.password2.errors %}is-invalid{% endif %}" 
                                                               id="password2" 
                                                               name="password2"
                                                               required>
                                                        <button class="btn btn-outline-secondary" type="button" onclick="togglePassword('password2', this)">
                                                            <i class="bi bi-eye"></i>
                                                        </button>
                                                        {% if form.password2.errors %}
                                                        <div class="invalid-feedback">
                                                            {{ form.password2.errors.0 }}
                                                        </div>
                                                        {% endif %}
                                                    </div>
                                                    <div class="password-match mt-2">
                                                        <small class="text-muted" id="passwordMatchText">Passwords must match</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Academic Information -->
                                    <div class="row mb-4" id="studentFields">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-mortarboard me-2"></i>Student Information
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="studentId" class="form-label">Student ID Number *</label>
                                                    <input type="text" 
                                                           class="form-control {% if form.student_id.errors %}is-invalid{% endif %}" 
                                                           id="studentId" 
                                                           name="student_id" 
                                                           value="{{ form.student_id.value|default:'' }}">
                                                    {% if form.student_id.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.student_id.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                    <div class="form-text">
                                                        Your official university student ID
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="department" class="form-label">Department *</label>
                                                    <select class="form-select {% if form.department.errors %}is-invalid{% endif %}" 
                                                            id="department" 
                                                            name="department">
                                                        <option value="">Select Department</option>
                                                        <option value="computer_science" {% if form.department.value == 'computer_science' %}selected{% endif %}>
                                                            Computer Science
                                                        </option>
                                                        <option value="mathematics" {% if form.department.value == 'mathematics' %}selected{% endif %}>
                                                            Mathematics
                                                        </option>
                                                        <option value="physics" {% if form.department.value == 'physics' %}selected{% endif %}>
                                                            Physics
                                                        </option>
                                                        <option value="chemistry" {% if form.department.value == 'chemistry' %}selected{% endif %}>
                                                            Chemistry
                                                        </option>
                                                        <option value="biology" {% if form.department.value == 'biology' %}selected{% endif %}>
                                                            Biology
                                                        </option>
                                                        <option value="engineering" {% if form.department.value == 'engineering' %}selected{% endif %}>
                                                            Engineering
                                                        </option>
                                                        <option value="medicine" {% if form.department.value == 'medicine' %}selected{% endif %}>
                                                            Medicine
                                                        </option>
                                                        <option value="law" {% if form.department.value == 'law' %}selected{% endif %}>
                                                            Law
                                                        </option>
                                                        <option value="arts" {% if form.department.value == 'arts' %}selected{% endif %}>
                                                            Arts & Humanities
                                                        </option>
                                                        <option value="business" {% if form.department.value == 'business' %}selected{% endif %}>
                                                            Business Administration
                                                        </option>
                                                    </select>
                                                    {% if form.department.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.department.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="academicYear" class="form-label">Academic Year</label>
                                                    <select class="form-select" id="academicYear" name="academic_year">
                                                        <option value="">Select Year</option>
                                                        <option value="100" {% if form.academic_year.value == '100' %}selected{% endif %}>
                                                            100 Level
                                                        </option>
                                                        <option value="200" {% if form.academic_year.value == '200' %}selected{% endif %}>
                                                            200 Level
                                                        </option>
                                                        <option value="300" {% if form.academic_year.value == '300' %}selected{% endif %}>
                                                            300 Level
                                                        </option>
                                                        <option value="400" {% if form.academic_year.value == '400' %}selected{% endif %}>
                                                            400 Level
                                                        </option>
                                                        <option value="500" {% if form.academic_year.value == '500' %}selected{% endif %}>
                                                            500 Level
                                                        </option>
                                                        <option value="postgraduate" {% if form.academic_year.value == 'postgraduate' %}selected{% endif %}>
                                                            Postgraduate
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Faculty/Staff Information -->
                                    <div class="row mb-4" id="facultyFields" style="display: none;">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-person-workspace me-2"></i>Faculty/Staff Information
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="facultyId" class="form-label">Faculty/Staff ID *</label>
                                                    <input type="text" 
                                                           class="form-control" 
                                                           id="facultyId" 
                                                           name="faculty_id" 
                                                           value="{{ form.faculty_id.value|default:'' }}">
                                                    <div class="form-text">
                                                        Your official university staff ID
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="facultyDepartment" class="form-label">Department/Faculty *</label>
                                                    <select class="form-select" id="facultyDepartment" name="faculty_department">
                                                        <option value="">Select Department/Faculty</option>
                                                        <option value="science" {% if form.faculty_department.value == 'science' %}selected{% endif %}>
                                                            Faculty of Science
                                                        </option>
                                                        <option value="engineering" {% if form.faculty_department.value == 'engineering' %}selected{% endif %}>
                                                            Faculty of Engineering
                                                        </option>
                                                        <option value="medicine" {% if form.faculty_department.value == 'medicine' %}selected{% endif %}>
                                                            Faculty of Medicine
                                                        </option>
                                                        <option value="law" {% if form.faculty_department.value == 'law' %}selected{% endif %}>
                                                            Faculty of Law
                                                        </option>
                                                        <option value="arts" {% if form.faculty_department.value == 'arts' %}selected{% endif %}>
                                                            Faculty of Arts
                                                        </option>
                                                        <option value="education" {% if form.faculty_department.value == 'education' %}selected{% endif %}>
                                                            Faculty of Education
                                                        </option>
                                                        <option value="social_sciences" {% if form.faculty_department.value == 'social_sciences' %}selected{% endif %}>
                                                            Faculty of Social Sciences
                                                        </option>
                                                        <option value="management" {% if form.faculty_department.value == 'management' %}selected{% endif %}>
                                                            Faculty of Management
                                                        </option>
                                                        <option value="pharmacy" {% if form.faculty_department.value == 'pharmacy' %}selected{% endif %}>
                                                            Faculty of Pharmacy
                                                        </option>
                                                    </select>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="position" class="form-label">Position</label>
                                                    <input type="text" 
                                                           class="form-control" 
                                                           id="position" 
                                                           name="position" 
                                                           value="{{ form.position.value|default:'' }}"
                                                           placeholder="e.g., Lecturer, Professor, Administrator">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Contact Information -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-telephone me-2"></i>Contact Information
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="phone" class="form-label">Phone Number *</label>
                                                    <input type="tel" 
                                                           class="form-control {% if form.phone.errors %}is-invalid{% endif %}" 
                                                           id="phone" 
                                                           name="phone" 
                                                           value="{{ form.phone.value|default:'' }}"
                                                           required>
                                                    {% if form.phone.errors %}
                                                    <div class="invalid-feedback">
                                                        {{ form.phone.errors.0 }}
                                                    </div>
                                                    {% endif %}
                                                    <div class="form-text">
                                                        Include country code (e.g., +2348012345678)
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="alternatePhone" class="form-label">Alternate Phone (Optional)</label>
                                                    <input type="tel" 
                                                           class="form-control" 
                                                           id="alternatePhone" 
                                                           name="alternate_phone" 
                                                           value="{{ form.alternate_phone.value|default:'' }}">
                                                </div>
                                                
                                                <div class="col-12">
                                                    <label for="address" class="form-label">Address (Optional)</label>
                                                    <textarea class="form-control" 
                                                              id="address" 
                                                              name="address" 
                                                              rows="2">{{ form.address.value|default:'' }}</textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Emergency Contact -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <h6 class="fw-bold mb-3">
                                                <i class="bi bi-person-plus me-2"></i>Emergency Contact
                                            </h6>
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <label for="emergencyName" class="form-label">Contact Person *</label>
                                                    <input type="text" 
                                                           class="form-control" 
                                                           id="emergencyName" 
                                                           name="emergency_contact" 
                                                           value="{{ form.emergency_contact.value|default:'' }}"
                                                           required>
                                                </div>
                                                
                                                <div class="col-md-6">
                                                    <label for="emergencyPhone" class="form-label">Contact Phone *</label>
                                                    <input type="tel" 
                                                           class="form-control" 
                                                           id="emergencyPhone" 
                                                           name="emergency_phone" 
                                                           value="{{ form.emergency_phone.value|default:'' }}"
                                                           required>
                                                </div>
                                                
                                                <div class="col-12">
                                                    <label for="emergencyRelation" class="form-label">Relationship *</label>
                                                    <select class="form-select" id="emergencyRelation" name="emergency_relation" required>
                                                        <option value="">Select Relationship</option>
                                                        <option value="parent" {% if form.emergency_relation.value == 'parent' %}selected{% endif %}>
                                                            Parent
                                                        </option>
                                                        <option value="sibling" {% if form.emergency_relation.value == 'sibling' %}selected{% endif %}>
                                                            Sibling
                                                        </option>
                                                        <option value="spouse" {% if form.emergency_relation.value == 'spouse' %}selected{% endif %}>
                                                            Spouse
                                                        </option>
                                                        <option value="relative" {% if form.emergency_relation.value == 'relative' %}selected{% endif %}>
                                                            Relative
                                                        </option>
                                                        <option value="friend" {% if form.emergency_relation.value == 'friend' %}selected{% endif %}>
                                                            Friend
                                                        </option>
                                                        <option value="guardian" {% if form.emergency_relation.value == 'guardian' %}selected{% endif %}>
                                                            Guardian
                                                        </option>
                                                        <option value="other" {% if form.emergency_relation.value == 'other' %}selected{% endif %}>
                                                            Other
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Terms and Conditions -->
                                    <div class="row mb-4">
                                        <div class="col-12">
                                            <div class="form-check">
                                                <input class="form-check-input {% if form.terms.errors %}is-invalid{% endif %}" 
                                                       type="checkbox" 
                                                       id="terms" 
                                                       name="terms" 
                                                       required>
                                                <label class="form-check-label" for="terms">
                                                    I agree to the 
                                                    <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#termsModal">
                                                        Terms and Conditions
                                                    </a>
                                                    and 
                                                    <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#privacyModal">
                                                        Privacy Policy
                                                    </a>
                                                    *
                                                </label>
                                                {% if form.terms.errors %}
                                                <div class="invalid-feedback">
                                                    {{ form.terms.errors.0 }}
                                                </div>
                                                {% endif %}
                                            </div>
                                            
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" 
                                                       type="checkbox" 
                                                       id="newsletter" 
                                                       name="newsletter">
                                                <label class="form-check-label" for="newsletter">
                                                    Subscribe to library newsletter and updates
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Form Actions -->
                                    <div class="row">
                                        <div class="col-12">
                                            <div class="d-grid gap-2">
                                                <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                                                    <i class="bi bi-person-plus me-2"></i>Create Account
                                                </button>
                                                <a href="{% url 'accounts:login' %}" class="btn btn-outline-primary">
                                                    <i class="bi bi-box-arrow-in-right me-2"></i>Already have an account? Login
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Right Column: Registration Benefits -->
                        <div class="col-lg-4 d-none d-lg-block">
                            <div class="registration-benefits h-100 p-5" 
                                 style="background: linear-gradient(135deg, var(--primary-blue), var(--accent-blue));">
                                <div class="text-white">
                                    <h3 class="fw-bold mb-4">Why Join Ramat Library?</h3>
                                    
                                    <div class="benefits-list">
                                        <div class="benefit-item mb-4">
                                            <div class="d-flex align-items-start">
                                                <i class="bi bi-book fs-4 me-3"></i>
                                                <div>
                                                    <h5 class="fw-bold mb-2">50,000+ Books</h5>
                                                    <p class="opacity-75 mb-0">
                                                        Access our extensive collection of academic resources
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="benefit-item mb-4">
                                            <div class="d-flex align-items-start">
                                                <i class="bi bi-laptop fs-4 me-3"></i>
                                                <div>
                                                    <h5 class="fw-bold mb-2">Digital Resources</h5>
                                                    <p class="opacity-75 mb-0">
                                                        24/7 access to e-books, journals, and research databases
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="benefit-item mb-4">
                                            <div class="d-flex align-items-start">
                                                <i class="bi bi-people fs-4 me-3"></i>
                                                <div>
                                                    <h5 class="fw-bold mb-2">Expert Assistance</h5>
                                                    <p class="opacity-75 mb-0">
                                                        Get help from our professional library staff
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="benefit-item mb-4">
                                            <div class="d-flex align-items-start">
                                                <i class="bi bi-calendar-event fs-4 me-3"></i>
                                                <div>
                                                    <h5 class="fw-bold mb-2">Workshops & Events</h5>
                                                    <p class="opacity-75 mb-0">
                                                        Join academic workshops and library events
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="benefit-item">
                                            <div class="d-flex align-items-start">
                                                <i class="bi bi-star fs-4 me-3"></i>
                                                <div>
                                                    <h5 class="fw-bold mb-2">Free Membership</h5>
                                                    <p class="opacity-75 mb-0">
                                                        No registration fees for UNIMAID affiliates
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-5 pt-4 border-top border-white border-opacity-25">
                                        <h5 class="fw-bold mb-3">Need Help?</h5>
                                        <p class="opacity-75 mb-3">
                                            Contact our support team for registration assistance
                                        </p>
                                        <div class="d-flex align-items-center">
                                            <i class="bi bi-envelope me-2"></i>
                                            <span>support@unimaid.edu.ng</span>
                                        </div>
                                        <div class="d-flex align-items-center mt-2">
                                            <i class="bi bi-telephone me-2"></i>
                                            <span>+234 80166 253 232</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms and Conditions Modal -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-gradient text-white">
                <h5 class="modal-title">Terms and Conditions</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="terms-content">
                    <h5 class="fw-bold mb-3">Ramat Library Membership Agreement</h5>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">1. Membership Eligibility</h6>
                        <p class="text-muted">
                            Membership is open to all University of Maiduguri students, faculty, staff, 
                            and authorized affiliates. You must provide accurate and complete information 
                            during registration.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">2. Borrowing Privileges</h6>
                        <p class="text-muted">
                            Members may borrow materials according to their membership type. Students may 
                            borrow up to 5 items for 14 days, while faculty may borrow up to 10 items for 
                            30 days.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">3. Responsibilities</h6>
                        <p class="text-muted">
                            Members are responsible for all materials borrowed on their account. Lost or 
                            damaged materials must be replaced or paid for. Overdue fines will be charged 
                            according to library policies.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">4. Digital Resources</h6>
                        <p class="text-muted">
                            Access to digital resources is for personal academic use only. Commercial use, 
                            systematic downloading, or redistribution of electronic resources is strictly 
                            prohibited.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">5. Privacy Policy</h6>
                        <p class="text-muted">
                            Your personal information will be used only for library operations and will not 
                            be shared with third parties without your consent, except as required by law.
                        </p>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        By creating an account, you agree to comply with all library rules and regulations.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Policy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content border-0 shadow-lg">
            <div class="modal-header bg-gradient text-white">
                <h5 class="modal-title">Privacy Policy</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="privacy-content">
                    <h5 class="fw-bold mb-3">Data Protection and Privacy</h5>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">1. Information Collection</h6>
                        <p class="text-muted">
                            We collect personal information necessary for library operations, including 
                            name, contact details, academic information, and borrowing history.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">2. Data Usage</h6>
                        <p class="text-muted">
                            Your information is used to provide library services, manage your account, 
                            send notifications, and generate usage statistics for library improvement.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">3. Data Protection</h6>
                        <p class="text-muted">
                            We implement appropriate security measures to protect your personal information 
                            from unauthorized access, alteration, or disclosure.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">4. Data Retention</h6>
                        <p class="text-muted">
                            Your information is retained for as long as you maintain an active account, 
                            plus a reasonable period for statistical and legal purposes after account closure.
                        </p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold">5. Your Rights</h6>
                        <p class="text-muted">
                            You have the right to access, correct, or delete your personal information. 
                            Contact the library administration for data-related inquiries.
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<style>
    /* Registration Page Specific Styles */
    .registration-page {
        padding-bottom: 4rem;
    }
    
    /* Membership Cards */
    .membership-option {
        cursor: pointer;
    }
    
    .membership-option .card {
        transition: all 0.3s ease;
        border-radius: 12px;
    }
    
    .membership-option .card.selected {
        border-color: var(--accent-blue) !important;
        box-shadow: 0 0 0 0.25rem rgba(58, 134, 255, 0.25);
    }
    
    .membership-option:hover .card:not(.selected) {
        border-color: #dee2e6;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    /* Form Validation */
    .form-control:valid {
        border-color: #198754;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    .form-control:invalid {
        border-color: #dc3545;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right calc(0.375em + 0.1875rem) center;
        background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
    }
    
    /* Benefits Sidebar */
    .registration-benefits {
        border-radius: 0 16px 16px 0;
    }
    
    .benefit-item {
        padding-left: 0.5rem;
        border-left: 3px solid rgba(255, 255, 255, 0.3);
    }
    
    /* Password Strength Indicator */
    .password-strength .progress {
        border-radius: 10px;
    }
    
    /* Modal Customization */
    .modal-content {
        border-radius: 16px;
        overflow: hidden;
    }
    
    /* Responsive Adjustments */
    @media (max-width: 992px) {
        .registration-benefits {
            display: none !important;
        }
        
        .membership-cards .col-md-6 {
            margin-bottom: 1rem;
        }
    }
    
    @media (max-width: 768px) {
        .card-body.p-5 {
            padding: 2rem !important;
        }
        
        .membership-option .card-body {
            padding: 1.5rem !important;
        }
    }
    
    /* Animation for form sections */
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .row.mb-4 {
        animation: fadeIn 0.5s ease forwards;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Membership type selection
        const membershipOptions = document.querySelectorAll('.membership-option');
        const membershipTypeInput = document.getElementById('membershipType');
        const studentFields = document.getElementById('studentFields');
        const facultyFields = document.getElementById('facultyFields');
        
        membershipOptions.forEach(option => {
            option.addEventListener('click', function() {
                const type = this.dataset.type;
                
                // Update selected card
                membershipOptions.forEach(opt => {
                    const card = opt.querySelector('.card');
                    card.classList.remove('selected', 'border-primary');
                    card.classList.add('border-light');
                });
                
                this.querySelector('.card').classList.add('selected', 'border-primary');
                this.querySelector('.card').classList.remove('border-light');
                
                // Update hidden input
                membershipTypeInput.value = type;
                
                // Show/hide relevant fields
                if (type === 'student') {
                    studentFields.style.display = 'block';
                    facultyFields.style.display = 'none';
                    
                    // Set required fields for student
                    document.getElementById('studentId').required = true;
                    document.getElementById('department').required = true;
                    document.getElementById('facultyId').required = false;
                    document.getElementById('facultyDepartment').required = false;
                } else if (type === 'faculty') {
                    studentFields.style.display = 'none';
                    facultyFields.style.display = 'block';
                    
                    // Set required fields for faculty
                    document.getElementById('studentId').required = false;
                    document.getElementById('department').required = false;
                    document.getElementById('facultyId').required = true;
                    document.getElementById('facultyDepartment').required = true;
                }
                
                // Remove error styling
                document.getElementById('membershipTypeError').style.display = 'none';
            });
        });
        
        // Initialize based on default value
        const defaultType = membershipTypeInput.value;
        if (defaultType) {
            const defaultOption = document.querySelector(`.membership-option[data-type="${defaultType}"]`);
            if (defaultOption) {
                defaultOption.click();
            }
        }
        
        // Password toggle visibility
        window.togglePassword = function(inputId, button) {
            const input = document.getElementById(inputId);
            const icon = button.querySelector('i');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'bi bi-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'bi bi-eye';
            }
        };
        
        // Password strength checker
        const passwordInput = document.getElementById('password1');
        const confirmPasswordInput = document.getElementById('password2');
        const strengthBar = document.getElementById('passwordStrengthBar');
        const strengthText = document.getElementById('passwordStrengthText');
        const matchText = document.getElementById('passwordMatchText');
        
        if (passwordInput) {
            passwordInput.addEventListener('input', function() {
                const password = this.value;
                checkPasswordStrength(password);
                checkPasswordMatch();
            });
        }
        
        if (confirmPasswordInput) {
            confirmPasswordInput.addEventListener('input', checkPasswordMatch);
        }
        
        function checkPasswordStrength(password) {
            let strength = 0;
            let color = 'bg-danger';
            let text = 'Very Weak';
            
            // Length check
            if (password.length >= 8) strength += 25;
            
            // Lowercase check
            if (/[a-z]/.test(password)) strength += 25;
            
            // Uppercase check
            if (/[A-Z]/.test(password)) strength += 25;
            
            // Number check
            if (/[0-9]/.test(password)) strength += 25;
            
            // Special character check (bonus)
            if (/[^A-Za-z0-9]/.test(password)) strength = Math.min(strength + 10, 100);
            
            // Set color and text based on strength
            if (strength >= 75) {
                color = 'bg-success';
                text = 'Strong';
            } else if (strength >= 50) {
                color = 'bg-warning';
                text = 'Medium';
            } else if (strength >= 25) {
                color = 'bg-info';
                text = 'Weak';
            }
            
            // Update UI
            strengthBar.style.width = `${strength}%`;
            strengthBar.className = `progress-bar ${color}`;
            strengthText.textContent = text;
            strengthText.className = `text-${color.replace('bg-', '')}`;
        }
        
        function checkPasswordMatch() {
            const password1 = passwordInput.value;
            const password2 = confirmPasswordInput.value;
            
            if (!password2) {
                matchText.textContent = 'Passwords must match';
                matchText.className = 'text-muted';
                return;
            }
            
            if (password1 === password2) {
                matchText.textContent = ' Passwords match';
                matchText.className = 'text-success';
            } else {
                matchText.textContent = ' Passwords do not match';
                matchText.className = 'text-danger';
            }
        }
        
        // Username availability check (simulated)
        const usernameInput = document.getElementById('username');
        if (usernameInput) {
            let usernameTimeout;
            
            usernameInput.addEventListener('input', function() {
                clearTimeout(usernameTimeout);
                
                const username = this.value;
                if (username.length < 3) return;
                
                usernameTimeout = setTimeout(() => {
                    // Simulate AJAX check
                    const takenUsernames = ['admin', 'test', 'user123', 'student'];
                    
                    if (takenUsernames.includes(username.toLowerCase())) {
                        showFieldError(this, 'Username is already taken');
                    } else if (!/^[a-zA-Z0-9_]+$/.test(username)) {
                        showFieldError(this, 'Only letters, numbers, and underscores allowed');
                    } else {
                        clearFieldError(this);
                    }
                }, 500);
            });
        }
        
        // Email format validation
        const emailInput = document.getElementById('email');
        if (emailInput) {
            emailInput.addEventListener('blur', function() {
                const email = this.value;
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                
                if (email && !emailRegex.test(email)) {
                    showFieldError(this, 'Please enter a valid email address');
                } else {
                    clearFieldError(this);
                }
            });
        }
        
        // Phone number validation
        const phoneInput = document.getElementById('phone');
        if (phoneInput) {
            phoneInput.addEventListener('blur', function() {
                const phone = this.value;
                const phoneRegex = /^\+?[\d\s\-\(\)]{10,}$/;
                
                if (phone && !phoneRegex.test(phone)) {
                    showFieldError(this, 'Please enter a valid phone number');
                } else {
                    clearFieldError(this);
                }
            });
        }
        
        // Student ID validation
        const studentIdInput = document.getElementById('studentId');
        if (studentIdInput) {
            studentIdInput.addEventListener('blur', function() {
                const studentId = this.value;
                
                if (studentId && !/^[A-Z0-9]{5,15}$/.test(studentId)) {
                    showFieldError(this, 'Student ID should be 5-15 alphanumeric characters');
                } else {
                    clearFieldError(this);
                }
            });
        }
        
        // Form submission
        const registrationForm = document.getElementById('registrationForm');
        const submitBtn = document.getElementById('submitBtn');
        
        if (registrationForm) {
            registrationForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate membership type
                if (!membershipTypeInput.value) {
                    document.getElementById('membershipTypeError').style.display = 'block';
                    document.querySelector('.membership-cards').scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                    return;
                }
                
                // Validate passwords match
                if (passwordInput.value !== confirmPasswordInput.value) {
                    showToast('error', 'Passwords do not match');
                    confirmPasswordInput.focus();
                    return;
                }
                
                // Validate password strength
                if (passwordInput.value.length < 8) {
                    showToast('error', 'Password must be at least 8 characters');
                    passwordInput.focus();
                    return;
                }
                
                // Validate terms agreement
                const termsCheckbox = document.getElementById('terms');
                if (!termsCheckbox.checked) {
                    showToast('error', 'You must agree to the terms and conditions');
                    return;
                }
                
                // Show loading state
                const originalText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Creating Account...';
                submitBtn.disabled = true;
                
                // Simulate form submission
                setTimeout(() => {
                    // In real implementation, this would submit the form
                    // For demo, show success message
                    showSuccessMessage();
                    
                    // Reset button
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }, 2000);
            });
        }
        
        // Helper functions
        function showFieldError(input, message) {
            input.classList.add('is-invalid');
            
            let errorDiv = input.nextElementSibling;
            if (!errorDiv || !errorDiv.classList.contains('invalid-feedback')) {
                errorDiv = document.createElement('div');
                errorDiv.className = 'invalid-feedback';
                input.parentNode.appendChild(errorDiv);
            }
            
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }
        
        function clearFieldError(input) {
            input.classList.remove('is-invalid');
            
            const errorDiv = input.nextElementSibling;
            if (errorDiv && errorDiv.classList.contains('invalid-feedback')) {
                errorDiv.style.display = 'none';
            }
        }
        
        function showSuccessMessage() {
            // Create success modal
            const successModal = document.createElement('div');
            successModal.className = 'modal fade';
            successModal.id = 'successModal';
            successModal.innerHTML = `
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg">
                        <div class="modal-header bg-gradient text-white border-0">
                            <h5 class="modal-title">Registration Successful!</h5>
                        </div>
                        <div class="modal-body p-5 text-center">
                            <div class="mb-4">
                                <div style="width: 100px; height: 100px; background: linear-gradient(135deg, #198754, #20c997); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
                                    <i class="bi bi-check-lg text-white fs-1"></i>
                                </div>
                            </div>
                            <h4 class="fw-bold mb-3">Welcome to Ramat Library!</h4>
                            <p class="text-muted mb-4">
                                Your account has been created successfully. 
                                You can now login to access library resources.
                            </p>
                            <div class="alert alert-info">
                                <i class="bi bi-info-circle me-2"></i>
                                A verification email has been sent to your inbox.
                            </div>
                        </div>
                        <div class="modal-footer border-0">
                            <a href="{% url 'accounts:login' %}" class="btn btn-primary w-100">
                                <i class="bi bi-box-arrow-in-right me-2"></i>Go to Login
                            </a>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(successModal);
            
            const modal = new bootstrap.Modal(successModal);
            modal.show();
            
            // Remove modal from DOM after hiding
            successModal.addEventListener('hidden.bs.modal', function() {
                successModal.remove();
            });
        }
        
        function showToast(type, message) {
            // Remove existing toasts
            const existingToasts = document.querySelectorAll('.custom-toast');
            existingToasts.forEach(toast => toast.remove());
            
            // Create toast
            const toast = document.createElement('div');
            toast.className = `custom-toast alert alert-${type} alert-dismissible fade show position-fixed`;
            toast.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            toast.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="bi bi-${type === 'success' ? 'check-circle' : 'exclamation-circle'}-fill fs-4 me-3"></i>
                    <div class="flex-grow-1">${message}</div>
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }
        
        // Initialize tooltips
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>
{% endblock %}